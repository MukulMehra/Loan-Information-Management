{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\projects\\\\information\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\projects\\\\information\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"D:\\\\projects\\\\information\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\projects\\\\information\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"D:\\\\projects\\\\information\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"D:\\\\projects\\\\information\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from'react';import{ElementsConsumer,CardElement}from'@stripe/react-stripe-js';import CardSection from'./CardSection';var CheckoutForm=/*#__PURE__*/function(_React$Component){_inherits(CheckoutForm,_React$Component);var _super=_createSuper(CheckoutForm);function CheckoutForm(){var _this;_classCallCheck(this,CheckoutForm);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event){var _this$props,stripe,elements,card,result,stripeTokenHandler;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:// We don't want to let default form submission happen here,\n// which would refresh the page.\nevent.preventDefault();_this$props=_this.props,stripe=_this$props.stripe,elements=_this$props.elements;if(!(!stripe||!elements)){_context2.next=4;break;}return _context2.abrupt(\"return\");case 4:card=elements.getElement(CardElement);_context2.next=7;return stripe.createToken(card);case 7:result=_context2.sent;if(result.error){// Show error to your customer.\nconsole.log(result.error.message);}else{stripeTokenHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(token){var paymentData,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:paymentData={token:token.id,cardElem:card};console.log(paymentData);// Use fetch to send the token ID and any other payment data to your server.\n// https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch\n_context.prev=2;_context.next=5;return fetch('https://us-central1-information-management-s-c7f1c.cloudfunctions.net/charge',{method:'POST',headers:{'Content-Type':'application/json'},body:console.log(JSON.stringify(paymentData))}).then(function(response){return console.log(response.json());});case 5:response=_context.sent;_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](2);console.log(\"this is error of catch \"+_context.t0);case 11:case\"end\":return _context.stop();}}},_callee,null,[[2,8]]);}));return function stripeTokenHandler(_x2){return _ref2.apply(this,arguments);};}();// Send the token to your server.\n// This function does not exist yet; we will define it in the next step.\nstripeTokenHandler(result.token);}case 9:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref.apply(this,arguments);};}();return _this;}_createClass(CheckoutForm,[{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"form\",{onSubmit:this.handleSubmit},/*#__PURE__*/React.createElement(CardSection,null),/*#__PURE__*/React.createElement(\"button\",{style:{marginLeft:'4vh'},disabled:!this.props.stripe},\"Confirm order\"));}}]);return CheckoutForm;}(React.Component);export default function InjectedCheckoutForm(){return/*#__PURE__*/React.createElement(ElementsConsumer,null,function(_ref3){var stripe=_ref3.stripe,elements=_ref3.elements;return/*#__PURE__*/React.createElement(CheckoutForm,{stripe:stripe,elements:elements});});}","map":{"version":3,"sources":["D:/projects/information/src/Copoments/Pages/Payment/CheckoutForm.js"],"names":["React","ElementsConsumer","CardElement","CardSection","CheckoutForm","handleSubmit","event","preventDefault","props","stripe","elements","card","getElement","createToken","result","error","console","log","message","stripeTokenHandler","token","paymentData","id","cardElem","fetch","method","headers","body","JSON","stringify","then","response","json","marginLeft","Component","InjectedCheckoutForm"],"mappings":"22BAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAAQC,gBAAR,CAA0BC,WAA1B,KAA4C,yBAA5C,CAEA,MAAOC,CAAAA,WAAP,KAAwB,eAAxB,C,GAEMC,CAAAA,Y,+VACJC,Y,0FAAe,kBAAOC,KAAP,qLACb;AACA;AACAA,KAAK,CAACC,cAAN,GAHa,YAKc,MAAKC,KALnB,CAKNC,MALM,aAKNA,MALM,CAKEC,QALF,aAKEA,QALF,MAOT,CAACD,MAAD,EAAW,CAACC,QAPH,oEAaPC,IAbO,CAaAD,QAAQ,CAACE,UAAT,CAAoBV,WAApB,CAbA,wBAcQO,CAAAA,MAAM,CAACI,WAAP,CAAmBF,IAAnB,CAdR,QAcPG,MAdO,gBAgBb,GAAIA,MAAM,CAACC,KAAX,CAAkB,CAChB;AACAC,OAAO,CAACC,GAAR,CAAYH,MAAM,CAACC,KAAP,CAAaG,OAAzB,EACD,CAHD,IAGO,CAISC,kBAJT,2FAIN,iBAAmCC,KAAnC,2IACSC,WADT,CACuB,CAClBD,KAAK,CAAEA,KAAK,CAACE,EADK,CAElBC,QAAQ,CAACZ,IAFS,CADvB,CAKIK,OAAO,CAACC,GAAR,CAAYI,WAAZ,EACD;AACA;AAPH,sCAU4BG,CAAAA,KAAK,CAAC,8EAAD,CAAiF,CAC3GC,MAAM,CAAE,MADmG,CAE3GC,OAAO,CAAE,CACP,eAAgB,kBADT,CAFkG,CAK3GC,IAAI,CAACX,OAAO,CAACC,GAAR,CAAYW,IAAI,CAACC,SAAL,CAAeR,WAAf,CAAZ,CALsG,CAAjF,CAAL,CAOpBS,IAPoB,CAOf,SAAAC,QAAQ,CAAG,CACf,MAAOf,CAAAA,OAAO,CAACC,GAAR,CAAYc,QAAQ,CAACC,IAAT,EAAZ,CAAP,CACH,CATsB,CAV5B,QAUWD,QAVX,8FAqBKf,OAAO,CAACC,GAAR,CAAY,qCAAZ,EArBL,oEAJM,kBAISE,CAAAA,kBAJT,+CACL;AACA;AACAA,kBAAkB,CAACL,MAAM,CAACM,KAAR,CAAlB,CAgCD,CAtDY,wD,6IAyDN,CACP,mBACE,4BAAM,QAAQ,CAAE,KAAKf,YAArB,eACE,oBAAC,WAAD,MADF,cAEE,8BAAQ,KAAK,CAAE,CAAC4B,UAAU,CAAC,KAAZ,CAAf,CAAmC,QAAQ,CAAE,CAAC,KAAKzB,KAAL,CAAWC,MAAzD,kBAFF,CADF,CAMD,C,0BAjEwBT,KAAK,CAACkC,S,EAoEjC,cAAe,SAASC,CAAAA,oBAAT,EAAgC,CAC7C,mBACE,oBAAC,gBAAD,MACG,mBAAE1B,CAAAA,MAAF,OAAEA,MAAF,CAAUC,QAAV,OAAUA,QAAV,oBACC,oBAAC,YAAD,EAAe,MAAM,CAAED,MAAvB,CAA+B,QAAQ,CAAEC,QAAzC,EADD,EADH,CADF,CAOD","sourcesContent":["import React from 'react';\r\nimport {ElementsConsumer, CardElement} from '@stripe/react-stripe-js';\r\n\r\nimport CardSection from './CardSection';\r\n\r\nclass CheckoutForm extends React.Component {\r\n  handleSubmit = async (event) => {\r\n    // We don't want to let default form submission happen here,\r\n    // which would refresh the page.\r\n    event.preventDefault();\r\n\r\n    const {stripe, elements} = this.props\r\n\r\n    if (!stripe || !elements) {\r\n      // Stripe.js has not yet loaded.\r\n      // Make  sure to disable form submission until Stripe.js has loaded.\r\n      return;\r\n    }\r\n\r\n    const card = elements.getElement(CardElement);\r\n    const result = await stripe.createToken(card);\r\n\r\n    if (result.error) {\r\n      // Show error to your customer.\r\n      console.log(result.error.message);\r\n    } else {\r\n      // Send the token to your server.\r\n      // This function does not exist yet; we will define it in the next step.\r\n      stripeTokenHandler(result.token);\r\n     async function stripeTokenHandler (token) {\r\n        const paymentData = {\r\n          token: token.id,\r\n          cardElem:card\r\n        };\r\n         console.log(paymentData);\r\n        // Use fetch to send the token ID and any other payment data to your server.\r\n        // https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch\r\n        try {\r\n          \r\n          const response = await fetch('https://us-central1-information-management-s-c7f1c.cloudfunctions.net/charge', {\r\n            method: 'POST',\r\n            headers: {\r\n              'Content-Type': 'application/json'\r\n            },\r\n            body:console.log(JSON.stringify(paymentData)),\r\n            \r\n          }).then(response =>{\r\n              return console.log(response.json());\r\n          });\r\n        } catch (error) {\r\n          console.log(\"this is error of catch \"+error);\r\n        }\r\n       \r\n      \r\n        // Return and display the result of the charge.\r\n       \r\n      }\r\n      \r\n      \r\n    \r\n    }\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <form onSubmit={this.handleSubmit}>\r\n        <CardSection />\r\n        <button style={{marginLeft:'4vh'}} disabled={!this.props.stripe}>Confirm order</button>\r\n      </form>\r\n    );\r\n  }\r\n}\r\n\r\nexport default function InjectedCheckoutForm() {\r\n  return (\r\n    <ElementsConsumer>\r\n      {({stripe, elements}) => (\r\n        <CheckoutForm  stripe={stripe} elements={elements} />\r\n      )}\r\n    </ElementsConsumer>\r\n  );\r\n}"]},"metadata":{},"sourceType":"module"}